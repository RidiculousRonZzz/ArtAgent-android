# ArtAgent-android
An Art Agent based on GPT4, Stable Diffusion, and finetuned VisualGLM-6B
# ArtAgent用户使用说明
ArtAgent的主界面是空白的，在使用时可以退出主界面，保留悬浮窗。悬浮窗可以随意滑动。

请保持网络畅通，不建议使用手机热点。
## 权限申请
1.请同意所有权限。

2.无障碍权限的开启：看到“无障碍服务”的弹窗提醒后，点击“好的”，然后在“交互控制”中选择“无障碍快捷方式”为“ArtAgent”，并把“ArtAgent”的“下载服务”打开。每次启动应用时都要开启一遍无障碍权限。
## 文本输入框
1.左下角的“<”按钮：单击，悬浮窗缩成一横条/横条展开变成“Tools”；双击，横条缩成小圆/小圆展开成横条。

2.在文本框里输入文字，点击右下角的“飞机”即可发送；也可点击录音按钮，文本框里会出现语音识别的结果，识别结束后点击“飞机”发送文字。
## “Tools”工具栏
1.点“Camera”即可拍摄图片并把其发至“Chat”聊天框中

2.点“Gallery”即可从系统相册中选取图片发至“Chat”聊天框中

3.点“Chat”可进入聊天界面。

4.点“Emotion”拍摄正脸可进行情绪识别。

5.点“Content”可获取当前页面上的所有文本。

6.点“Location”可获取当前位置。
## “Chat”聊天界面
1.点击“Tools”回到“Tools”界面。

2.点击“Draw”，根据艺术讨论结果生成图片。

3.点击“Clear”清除所有聊天记录，开启新对话。

4.点击“Edit”，根据艺术讨论结果修改当前图片。
## “文生图”测试流程
1.当您发送第一条绘画指令时，ArtAgent会根据您的指令和您现在所处的情境给出3个推荐主题。您可以从1到3中选择一个数字回复，它会根据您选择的主题发挥想象，进行绘画场景的描述。之后，您可以继续与它讨论，说出您的改正意见；也可以点击“Draw”按钮，根据之前的艺术讨论生成图像。

2.如果生成的图像不满足您的需求，您可以继续提出改正意见，与它讨论，并点击“Draw”按钮再次生成新的图像。
## “图生图”测试流程
1.您可以通过拍摄（点击“Camera”）或选择系统相册中的图片（点击“Gallery”）进行图生图测试。

2.发送该图片至聊天框后，您会收到ArtAgent对于该图片的描述，和3个推荐的修改主题。这3个修改主题有时会基于您所处的情境。您可以从1到3中选择一个数字回复，它会根据您选择的主题发挥想象，进行绘画场景的描述。之后，您可以继续与它讨论，说出您的改正意见；也可以点击“Edit”按钮，根据之前的艺术讨论进行图像编辑。

3.“Edit”右侧的数字代表待修改图片的ImageID，默认为最新图片的ImageID。该ID会在每次您发送图片/生成图片时给出。
# TODO
从相册中选择图片发到聊天框里时，MainActivity的界面老是弹出来

如何把听歌识曲和情绪识别与ivsend.click绑定

无障碍识别的问题：公众号文章有时无法识别

现在先不取消各个功能显示的界面，怕出错，可以在点击文本框发送的时候再加个 log

服务器正在处理请求的时候加上旋转的 loading…

返回图片会有网络问题：java.net.SocketException: Connection reset 可能是我流量数据的问题，用校园网就好

无法在其他应用中使用键盘（WindowManager.LayoutParams.TYPE_APPLICATION_OVERLAY的性质，暂时没法改）
